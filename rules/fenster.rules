rule "Es regnet"
    when
    	Item EsRegnet changed to ON
    then
    	logInfo("Fenster","Es regnet, Fenster prüfen")
    	
			//Wohnzimmerfenster checken
			if (mihome_sensor_magnet_aq2_158d0002722d11_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und die Terassentür im Wohnzimmer ist offen")
			}
			//Küchenfenster links checken
			if (mihome_sensor_magnet_aq2_158d0002750f0b_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und ein Fenster in der Küche ist offen")
			}
			//Küchenfenster rechts checken
			if (mihome_sensor_magnet_aq2_158d0002722c1f_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und ein Fenster in der Küche ist offen")
			}
			//Ankleide checken
			if (mihome_sensor_magnet_aq2_158d000274ff63_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und das Fenster in der Ankleide ist offen")
			}
			//Badezimmer checken
			if (mihome_sensor_magnet_aq2_158d000272f055_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und das Fenster im Badezimmer ist offen")
			}
			//Dachzimmer checken
			if (mihome_sensor_magnet_aq2_158d0002750d62_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und das Fenster im Dachzimmer ist offen")
			}
			//Kinderzimmer checken
			if (mihome_sensor_magnet_aq2_158d0002726015_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und das Fenster im Kinderzimmer ist offen")
			}
			//Schlafzimmer links checken
			if (mihome_sensor_magnet_aq2_158d000272ef20_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und ein Fenster im Schlafzimmer ist offen")
			}
			//Küchenfenster rechts checken
			if (mihome_sensor_magnet_aq2_158d000272ecaf_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und ein Fenster im Schlafzimmer ist offen")
			}
		}
	end

rule"FensterGeschlossen"
	when
		Item gFenster received update // NOTE: the rule will trigger multiple times per event
	then
		Thread::sleep(500) // give persistence time to catch up
		val AnzahlFenster = gFenster.members.filter(s|s.state==OPEN).size
		AnzahlOffeneFenster.postUpdate(AnzahlFenster)
	end
