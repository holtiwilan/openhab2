rule "Es regnet"
    when
    	Item Weather_Today_Icon changed
    then
		// prüfen, ob es regnet
        var rain = Weather_Today_Icon.state == "flurries" ||    				
					Weather_Today_Icon.state == "rain" || 
        			Weather_Today_Icon.state == "sleet" ||
        			Weather_Today_Icon.state == "snow" ||
        			Weather_Today_Icon.state == "tstorms"
	
		if (rain) {
    	    logInfo("Fenster","Es regnet, Fenster prüfen")
    	
			//Wohnzimmerfenster checken
			if (mihome_sensor_magnet_aq2_158d0002722d11_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und die Terassentür im Wohnzimmer ist offen")
			}
			//Küchenfenster links checken
			if (mihome_sensor_magnet_aq2_158d0002750f0b_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und ein Fenster in der Küche ist offen")
			}
			//Küchenfenster rechts checken
			if (mihome_sensor_magnet_aq2_158d0002722c1f_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und ein Fenster in der Küche ist offen")
			}
			//Ankleide checken
			if (mihome_sensor_magnet_aq2_158d000274ff63_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und das Fenster in der Ankleide ist offen")
			}
			//Badezimmer checken
			if (mihome_sensor_magnet_aq2_158d000272f055_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und das Fenster im Badezimmer ist offen")
			}
			//Dachzimmer checken
			if (mihome_sensor_magnet_aq2_158d0002750d62_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und das Fenster im Dachzimmer ist offen")
			}
			//Kinderzimmer checken
			if (mihome_sensor_magnet_aq2_158d0002726015_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und das Fenster im Kinderzimmer ist offen")
			}
			//Schlafzimmer links checken
			if (mihome_sensor_magnet_aq2_158d000272ef20_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und ein Fenster im Schlafzimmer ist offen")
			}
			//Küchenfenster rechts checken
			if (mihome_sensor_magnet_aq2_158d000272ecaf_isOpen.state == OPEN) {
				sendTelegram("bot2", "Es regnet und ein Fenster im Schlafzimmer ist offen")
			}
		}
	end

rule "Nachricht"
    when
    	Item Nachricht changed
    then
        sendCommand(mihome_gateway_7c49ebb1dc1b_volume, 30)
        sendCommand(mihome_gateway_7c49ebb1dc1b_sound, 10002)
        Thread::sleep(5000) /* wait for 5 seconds */
        sendCommand(mihome_gateway_7c49ebb1dc1b_sound, 10000)
        sendCommand(mihome_gateway_7c49ebb1dc1b_volume, 0)
    end
